import torch

def repeat_kv(hidden_states: torch.Tensor, n_rep: int) -> torch.Tensor:
    # Utility function code here...
    pass

def apply_rotary_pos_emb(q, k, cos, sin, unsqueeze_dim=1):
    # Utility function code here...
    pass

def rotate_half(x):
    # Utility function code here...
    pass
